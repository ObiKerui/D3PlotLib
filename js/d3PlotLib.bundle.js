!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.d3PlotLib=e():t.d3PlotLib=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(){let t={},e=function(e,n){let r=[],i=[];n.forEach((t=>{let e=t.xs();r.push(e);let n=t.ys();Array.isArray(n[0])?i.push(...n):i.push(n)}));let o=e.chartWidth,l=e.chartHeight,a=t.xScale;"function"==typeof a&&(a=a(r[0],o));let s=t.yScale;"function"==typeof s&&(s=s(i,l)),a&&a.rangeRound([0,o]),s&&s.rangeRound([l,0]),e.xScale=a,e.yScale=s};function n(n){return function(r){return arguments.length?(t[n]=r,e):t[n]}}for(let r in t)!e[r]&&t.hasOwnProperty(r)&&(e[r]=n(r));return e.attr=function(){return t},e.xScale=function(n){return arguments.length?(t.xScale=n,e):e.xScale},e.yScale=function(n){return arguments.length?(t.yScale=n,e):e.yScale},e}t.r(e),t.d(e,{AxLine:()=>h,AyLine:()=>d,BarPlot:()=>Tr,BoxPlot:()=>ri,CandlestickPlot:()=>Fr,Container:()=>s,DevBrush:()=>Pi,DevHexBinLayer:()=>Si,DevLabels:()=>Di,DevMapContainer:()=>bi,DevMapLayer:()=>Ai,DevMapMarkers:()=>Oi,DevMapProjection:()=>_i,DevZoom:()=>Ii,DonutPlot:()=>ai,FillArea:()=>Qr,GroupedBarPlot:()=>Ur,Heatmap:()=>fi,Hist:()=>Xr,Legend:()=>Br,MapContainer:()=>gi,MapLayer:()=>xi,MapMarkers:()=>mi,MovingAverageCalc:()=>Zr,Plot:()=>c,Scaler:()=>n,ScatterPlot:()=>ui,StackedArea:()=>Yr,StackedBar:()=>ei,ViolinPlot:()=>oi});const r={tag:null,xs:[],ys:[],labels:[],plotID:null,index:null,alpha:[],styles:[],colours:[],curve:null},i={tag:null,density:null,bins:null,colours:[]},o={tag:null,xs:[],ys:[],lineID:null,index:null,alpha:null,colours:null,labels:null,styles:null},l={legendID:null,index:null,data:null,position:null},a=Object.assign(Object.assign(Object.assign({},{xScale:null,yScale:null}),{svg:null,width:500,height:400,margin:{bottom:50,left:40,right:60,top:20},chartWidth:0,chartHeight:0,showMargins:!1,scale:null,legend:null}),{xAxis:null,xAxisLabel:"",xAxisPosition:"bottom",xAxisLabelOffset:30,xAxisText:{rotation:0},xAxisLabelEl:null,xTicks:5,xAxisShow:!0,xGrid:null,xGridShow:!1,yAxis:null,yAxisLabel:"",yAxisPosition:"left",yAxisLabelOffset:-30,yAxisLabelEl:null,yAxisPaddingBetweenChart:10,yTicks:5,yAxisShow:!0,yGrid:null,yGridShow:!0,yAxisText:{rotation:0}});function s(){let t=JSON.parse(JSON.stringify(a)),e=[];const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");function r(n){var r;t.chartWidth=t.width-t.margin.left-t.margin.right,t.chartHeight=t.height-t.margin.top-t.margin.bottom,r=n.node(),t.svg||(t.svg=d3.select(r).append("svg").classed("jschart-container",!0),function(e){let n=t.margin.left,r=t.margin.top,i=e.append("g").classed("container-group",!0).attr("transform",`translate(${n},${r})`);i.append("g").classed("x-axis-group grid",!0),i.append("g").classed("y-axis-group grid",!0),i.append("g").classed("chart-group",!0),i.append("g").classed("x-axis-group axis",!0),i.append("g").classed("x-axis-label",!0),i.append("g").classed("y-axis-group axis",!0),i.append("g").classed("y-axis-label",!0),i.append("g").classed("metadata-group",!0)}(t.svg)),t.svg.attr("width",t.width).attr("height",t.height),function(){let n=null==t.scale?null:t.scale;n&&n(t,e)}(),t.xAxis=t.yAxis=null,null!=t.xScale&&null!=t.yScale&&(t.xAxis=d3.axisBottom(t.xScale),"right"==t.yAxisPosition?t.yAxis=d3.axisRight(t.yScale):t.yAxis=d3.axisLeft(t.yScale),t.yAxis.ticks(10,"%").tickFormat((function(t){return t/1e3>=1&&(t=t/1e3+"K"),t}))),t.xGrid=t.yGrid=null,null!=t.xScale&&null!=t.yScale&&(t.xGrid=d3.axisBottom(t.xScale).tickSize(-t.chartHeight).tickFormat("").ticks(10),"right"==t.yAxisPosition?t.yGrid=d3.axisRight(t.yScale):t.yGrid=d3.axisLeft(t.yScale),t.yGrid.tickSize(-t.chartWidth).tickFormat("").ticks(10)),e.forEach((e=>{e(t)})),function(){let e=0;"right"==t.yAxisPosition&&(e=t.chartWidth+4),t.xGridShow&&t.xGrid&&t.svg.select(".x-axis-group.grid").attr("transform",`translate(0,${t.chartHeight})`).call(t.xGrid).style("opacity",.3),t.yGridShow&&t.yGrid&&t.svg.select(".y-axis-group.grid").attr("transform",`translate(${e})`).call(t.yGrid).style("opacity",.3)}(),function(){var e,n;let r=null!==(e=t.xAxisText.rotation)&&void 0!==e?e:0,i="middle",o="0em",l="1em";0!==r&&(i="start",o=".8em",l=".15em");let a=null!==(n=t.yAxisText.rotation)&&void 0!==n?n:0,s="0em";let u=0;"right"==t.yAxisPosition&&(u=t.chartWidth+4),t.xAxisShow&&t.xAxis&&(t.svg.select(".x-axis-group.axis").attr("transform",`translate(0,${t.chartHeight})`).call(t.xAxis),t.svg.select(".x-axis-group.axis").selectAll("text").style("font","10px Arial, sans-serif").style("text-anchor",i).attr("dx",o).attr("dy",l).attr("transform",`rotate(${r})`)),t.yAxisShow&&t.yAxis&&(t.svg.select(".y-axis-group.axis").attr("transform",`translate(${u}, 0)`).call(t.yAxis),t.svg.select(".y-axis-group.axis").selectAll("text").style("font","10px Arial, sans-serif").attr("transform",`rotate(${a})`))}(),function(){let e=0;"right"==t.yAxisPosition&&(e=t.chartWidth+80),t.yAxisLabel&&(t.yAxisLabelEl&&t.yAxisLabelEl.remove(),t.yAxisLabelEl=t.svg.select(".y-axis-label").attr("transform",`translate(${e}, 0)`).append("text").classed("y-axis-label-text",!0).attr("x",-t.chartHeight/2).attr("y",t.yAxisLabelOffset).attr("text-anchor","middle").attr("transform","rotate(270 0 0)").text(t.yAxisLabel)),t.xAxisLabel&&(t.xAxisLabelEl&&t.xAxisLabelEl.remove(),t.xAxisLabelEl=t.svg.select(".x-axis-label").attr("transform",`translate(0,${t.chartHeight})`).append("text").attr("y",t.xAxisLabelOffset).attr("text-anchor","middle").classed("x-axis-label-text",!0).attr("x",t.chartWidth/2).text(t.xAxisLabel))}(),null!=t.legend&&t.legend(t,e),t.showMargins&&t.svg&&t.svg.style("background-color","rgba(255, 0, 0, .2)")}let i=r;function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e},r.attr=function(){return t},r.plot=function(t){if(Number.isInteger(t)&&e.length>0)return e[t];if("string"==typeof t){let n=e.filter((e=>e.tag()===t));return n.length>0?n[0]:null}return e.push(t),r},r}const u=["red","green","blue","grey"];function c(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(r){e=r,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.plotID}`).size()>0)return;t.index=r.size(),t.plotID=`plot-${t.index}`;let i=n.append("g").classed(`${t.plotID}`,!0),o=e.chartWidth,l=e.chartHeight;t.clipPathId=`${t.plotID}-clippath`,i.append("clipPath").attr("id",t.clipPathId).append("rect").attr("width",o+30).attr("height",l),t.index,t.colours=0===t.colours.length?u:t.colours}(),t.ys=Array.isArray(t.ys[0])?t.ys:[t.ys],t.labels=Array.isArray(t.labels)?t.labels:[t.labels],t.colours=Array.isArray(t.colours)?t.colours:[t.colours],t.styles=Array.isArray(t.styles)?t.styles:[t.styles],t.alpha=Array.isArray(t.alpha)?t.alpha:[t.alpha],function(){var r;let i=t.ys,o=t.xs,l=(t.index,t.colours),a=e.xScale,s=e.yScale,u=(e.width,e.height,t.alpha),c=(t.styles,""),f=null!==(r=t.curve)&&void 0!==r?r:d3.curveLinear,h=e.svg.select(`.${t.plotID}`).selectAll(".lines").data(i);h.exit().style("opacity",0).remove();let p=h.enter().append("path").classed("lines",!0).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5);h=h.merge(p),h.attr("d",d3.line().curve(f).x((function(t,e){return a(o[e])})).y((function(t){return s(t)}))).attr("clip-path",`url(#${t.clipPathId})`).attr("stroke",((t,e)=>l[e])).style("opacity",((t,e)=>u[e])).style(c,"3, 3").on("mouseover",(function(t){d3.select(this).style("cursor","pointer"),n.call("customMouseOver",this,t)})).on("mousemove",(function(t){n.call("customMouseMove",this,t)})).on("mouseout",(function(t){n.call("customMouseOut",this,t)})).on("click",(function(t){n.call("customMouseClick",this,t)}))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},i}const f=["red","green","blue","grey"];function h(){let t=JSON.parse(JSON.stringify(o)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=function(r){e=r,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.lineID}`).size()>0)return;t.index=r.size(),t.lineID=`line-${t.index}`,n.append("g").classed(`${t.lineID}`,!0);let i=e.chartWidth,o=e.chartHeight;t.clipPathId=`${t.plotID}-clippath`,n.append("clipPath").attr("id",t.clipPathId).append("rect").attr("width",i+30).attr("height",o);let l=t.index%f.length;t.colour=f[l]}(),t.ys=Array.isArray(t.ys[0])?t.ys:[t.ys],t.labels=Array.isArray(t.labels)?t.labels:[t.labels],t.colours=Array.isArray(t.colours)?t.colours:[t.colours],t.styles=Array.isArray(t.styles)?t.styles:[t.styles],t.alpha=Array.isArray(t.alpha)?t.alpha:[t.alpha],function(){t.ys;let r=t.xs,i=t.colour,o=e.xScale,l=e.yScale,a=t.alpha,s=t.style,u="",c=e.svg;"--"==s&&(u="stroke-dasharray");let f=l.domain()[0],h=l.domain()[1],p=r,d=c.select(`.${t.lineID}`).selectAll(".lines").data(p);d.exit().style("opacity",0).remove();let g=d.enter().append("line").classed("lines",!0).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5);d=d.merge(g),d.attr("x1",(function(t,e){return o(t)})).attr("x2",(function(t,e){return o(t)})).attr("y1",(function(t,e){return l(f)})).attr("y2",(function(t,e){return l(h)})).attr("clip-path",`url(#${t.clipPathId})`).attr("stroke",i).style("opacity",a).style(u,"3, 3").on("mouseover",(function(t){d3.select(this).style("cursor","pointer"),n.call("customMouseOver",this,t)})).on("mousemove",(function(t){n.call("customMouseMove",this,t)})).on("mouseout",(function(t){n.call("customMouseOut",this,t)})).on("click",(function(t){n.call("customMouseClick",this,t)}))}()};function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e},r.attr=function(){return t},r.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},r}const p=["red","green","blue","grey"];function d(){let t=JSON.parse(JSON.stringify(o)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=function(r){e=r,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.lineID}`).size()>0)return;t.index=r.size(),t.lineID=`line-${t.index}`,n.append("g").classed(`${t.lineID}`,!0);let i=e.chartWidth,o=e.chartHeight;t.clipPathId=`${t.plotID}-clippath`,n.append("clipPath").attr("id",t.clipPathId).append("rect").attr("width",i+30).attr("height",o);let l=t.index%p.length;t.colour=p[l]}(),t.labels=Array.isArray(t.labels)?t.labels:[t.labels],t.colours=Array.isArray(t.colours)?t.colours:[t.colours],t.styles=Array.isArray(t.styles)?t.styles:[t.styles],t.alpha=Array.isArray(t.alpha)?t.alpha:[t.alpha],function(){let r=t.ys,i=(t.xs,t.colour),o=e.xScale,l=e.yScale,a=t.alpha,s=t.style,u="",c=e.svg;"--"==s&&(u="stroke-dasharray");let f=d3.extent(o.domain()),h=f[0],p=f[1],d=r;o=d3.scaleLinear().domain(d3.extent(o.domain())).range(o.range());let g=c.select(`.${t.lineID}`).selectAll(".lines").data(d);g.exit().style("opacity",0).remove();let y=g.enter().append("line").classed("lines",!0).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5);g=g.merge(y),g.attr("x1",(function(t,e){return o(h)})).attr("x2",(function(t,e){return o(p)})).attr("y1",(function(t,e){return l(t)})).attr("y2",(function(t,e){return l(t)})).attr("clip-path",`url(#${t.clipPathId})`).attr("stroke",i).style("opacity",a).style(u,"3, 3").on("mouseover",(function(t){d3.select(this).style("cursor","pointer"),n.call("customMouseOver",this,t)})).on("mousemove",(function(t){n.call("customMouseMove",this,t)})).on("mouseout",(function(t){n.call("customMouseOut",this,t)})).on("click",(function(t){n.call("customMouseClick",this,t)}))}()};function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e},r.attr=function(){return t},r}function g(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var y,m;function v(t,e){var n,r,i,o=t.length,l=-1;if(null==e){for(;++l<o;)if(null!=(n=t[l])&&n>=n)for(r=i=n;++l<o;)null!=(n=t[l])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++l<o;)if(null!=(n=e(t[l],l,t))&&n>=n)for(r=i=n;++l<o;)null!=(n=e(t[l],l,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]}1===(y=g).length&&(m=y,y=function(t,e){return g(m(t),e)});var x=Array.prototype;function w(){}function b(t){return null==t?w:function(){return this.querySelector(t)}}function M(){return[]}function A(t){return null==t?M:function(){return this.querySelectorAll(t)}}function k(t){return function(){return this.matches(t)}}function O(t){return new Array(t.length)}function N(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function S(t,e,n,r,i,o){for(var l,a=0,s=e.length,u=o.length;a<u;++a)(l=e[a])?(l.__data__=o[a],r[a]=l):n[a]=new N(t,o[a]);for(;a<s;++a)(l=e[a])&&(i[a]=l)}function I(t,e,n,r,i,o,l){var a,s,u,c={},f=e.length,h=o.length,p=new Array(f);for(a=0;a<f;++a)(s=e[a])&&(p[a]=u="$"+l.call(s,s.__data__,a,e),u in c?i[a]=s:c[u]=s);for(a=0;a<h;++a)(s=c[u="$"+l.call(t,o[a],a,o)])?(r[a]=s,s.__data__=o[a],c[u]=null):n[a]=new N(t,o[a]);for(a=0;a<f;++a)(s=e[a])&&c[p[a]]===s&&(i[a]=s)}function $(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}x.slice,x.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2),Array.prototype.slice,N.prototype={constructor:N,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var D="http://www.w3.org/1999/xhtml";const P={svg:"http://www.w3.org/2000/svg",xhtml:D,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function C(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),P.hasOwnProperty(e)?{space:P[e],local:t}:t}function z(t){return function(){this.removeAttribute(t)}}function E(t){return function(){this.removeAttributeNS(t.space,t.local)}}function j(t,e){return function(){this.setAttribute(t,e)}}function R(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function J(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function q(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function T(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function H(t){return function(){this.style.removeProperty(t)}}function U(t,e,n){return function(){this.style.setProperty(t,e,n)}}function W(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function X(t,e){return t.style.getPropertyValue(e)||T(t).getComputedStyle(t,null).getPropertyValue(e)}function B(t){return function(){delete this[t]}}function G(t,e){return function(){this[t]=e}}function Y(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function V(t){return t.trim().split(/^|\s+/)}function F(t){return t.classList||new Z(t)}function Z(t){this._node=t,this._names=V(t.getAttribute("class")||"")}function K(t,e){for(var n=F(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Q(t,e){for(var n=F(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function tt(t){return function(){K(this,t)}}function et(t){return function(){Q(this,t)}}function nt(t,e){return function(){(e.apply(this,arguments)?K:Q)(this,t)}}function rt(){this.textContent=""}function it(t){return function(){this.textContent=t}}function ot(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function lt(){this.innerHTML=""}function at(t){return function(){this.innerHTML=t}}function st(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ut(){this.nextSibling&&this.parentNode.appendChild(this)}function ct(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ft(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===D&&e.documentElement.namespaceURI===D?e.createElement(t):e.createElementNS(n,t)}}function ht(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function pt(t){var e=C(t);return(e.local?ht:ft)(e)}function dt(){return null}function gt(){var t=this.parentNode;t&&t.removeChild(this)}function yt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}Z.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var vt={},xt=null;function wt(t,e,n){return t=bt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function bt(t,e,n){return function(r){var i=xt;xt=r;try{t.call(this,this.__data__,e,n)}finally{xt=i}}}function _t(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Mt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function At(t,e,n){var r=vt.hasOwnProperty(t.type)?wt:bt;return function(i,o,l){var a,s=this.__on,u=r(e,o,l);if(s)for(var c=0,f=s.length;c<f;++c)if((a=s[c]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=u,a.capture=n),void(a.value=e);this.addEventListener(t.type,u,n),a={type:t.type,name:t.name,value:e,listener:u,capture:n},s?s.push(a):this.__on=[a]}}function kt(t,e,n){var r=T(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ot(t,e){return function(){return kt(this,t,e)}}function Nt(t,e){return function(){return kt(this,t,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(vt={mouseenter:"mouseover",mouseleave:"mouseout"}));var St=[null];function It(t,e){this._groups=t,this._parents=e}function $t(){return new It([[document.documentElement]],St)}It.prototype=$t.prototype={constructor:It,select:function(t){"function"!=typeof t&&(t=b(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,l,a=e[i],s=a.length,u=r[i]=new Array(s),c=0;c<s;++c)(o=a[c])&&(l=t.call(o,o.__data__,c,a))&&("__data__"in o&&(l.__data__=o.__data__),u[c]=l);return new It(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=A(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var l,a=e[o],s=a.length,u=0;u<s;++u)(l=a[u])&&(r.push(t.call(l,l.__data__,u,a)),i.push(l));return new It(r,i)},filter:function(t){"function"!=typeof t&&(t=k(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,l=e[i],a=l.length,s=r[i]=[],u=0;u<a;++u)(o=l[u])&&t.call(o,o.__data__,u,l)&&s.push(o);return new It(r,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),c=-1,this.each((function(t){d[++c]=t})),d;var n,r=e?I:S,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var l=o.length,a=new Array(l),s=new Array(l),u=new Array(l),c=0;c<l;++c){var f=i[c],h=o[c],p=h.length,d=t.call(f,f&&f.__data__,c,i),g=d.length,y=s[c]=new Array(g),m=a[c]=new Array(g);r(f,h,y,m,u[c]=new Array(p),d,e);for(var v,x,w=0,b=0;w<g;++w)if(v=y[w]){for(w>=b&&(b=w+1);!(x=m[b])&&++b<g;);v._next=x||null}}return(a=new It(a,i))._enter=s,a._exit=u,a},enter:function(){return new It(this._enter||this._groups.map(O),this._parents)},exit:function(){return new It(this._exit||this._groups.map(O),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),l=new Array(r),a=0;a<o;++a)for(var s,u=e[a],c=n[a],f=u.length,h=l[a]=new Array(f),p=0;p<f;++p)(s=u[p]||c[p])&&(h[p]=s);for(;a<r;++a)l[a]=e[a];return new It(l,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,l=i[o];--o>=0;)(r=i[o])&&(l&&4^r.compareDocumentPosition(l)&&l.parentNode.insertBefore(r,l),l=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=$);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var l,a=n[o],s=a.length,u=i[o]=new Array(s),c=0;c<s;++c)(l=a[c])&&(u[c]=l);u.sort(e)}return new It(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var l=r[i];if(l)return l}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],l=0,a=o.length;l<a;++l)(i=o[l])&&t.call(i,i.__data__,l,o);return this},attr:function(t,e){var n=C(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?E:z:"function"==typeof e?n.local?q:J:n.local?R:j)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?H:"function"==typeof e?W:U)(t,e,null==n?"":n)):X(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?B:"function"==typeof e?Y:G)(t,e)):this.node()[t]},classed:function(t,e){var n=V(t+"");if(arguments.length<2){for(var r=F(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?nt:e?tt:et)(n,e))},text:function(t){return arguments.length?this.each(null==t?rt:("function"==typeof t?ot:it)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?lt:("function"==typeof t?st:at)(t)):this.node().innerHTML},raise:function(){return this.each(ut)},lower:function(){return this.each(ct)},append:function(t){var e="function"==typeof t?t:pt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:pt(t),r=null==e?dt:"function"==typeof e?e:b(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(gt)},clone:function(t){return this.select(t?mt:yt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=_t(t+""),l=o.length;if(!(arguments.length<2)){for(a=e?At:Mt,null==n&&(n=!1),r=0;r<l;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var s,u=0,c=a.length;u<c;++u)for(r=0,s=a[u];r<l;++r)if((i=o[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(t,e){return this.each(("function"==typeof e?Nt:Ot)(t,e))}};const Dt=$t;var Pt={value:function(){}};function Ct(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Lt(r)}function Lt(t){this._=t}function zt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Et(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function jt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Pt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Lt.prototype=Ct.prototype={constructor:Lt,on:function(t,e){var n,r=this._,i=zt(t+"",r),o=-1,l=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<l;)if(n=(t=i[o]).type)r[n]=jt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=jt(r[n],t.name,null);return this}for(;++o<l;)if((n=(t=i[o]).type)&&(n=Et(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Lt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const Rt=Ct;var Jt,qt,Tt=0,Ht=0,Ut=0,Wt=0,Xt=0,Bt=0,Gt="object"==typeof performance&&performance.now?performance:Date,Yt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Vt(){return Xt||(Yt(Ft),Xt=Gt.now()+Bt)}function Ft(){Xt=0}function Zt(){this._call=this._time=this._next=null}function Kt(t,e,n){var r=new Zt;return r.restart(t,e,n),r}function Qt(){Xt=(Wt=Gt.now())+Bt,Tt=Ht=0;try{!function(){Vt(),++Tt;for(var t,e=Jt;e;)(t=Xt-e._time)>=0&&e._call.call(null,t),e=e._next;--Tt}()}finally{Tt=0,function(){for(var t,e,n=Jt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Jt=e);qt=t,ee(r)}(),Xt=0}}function te(){var t=Gt.now(),e=t-Wt;e>1e3&&(Bt-=e,Wt=t)}function ee(t){Tt||(Ht&&(Ht=clearTimeout(Ht)),t-Xt>24?(t<1/0&&(Ht=setTimeout(Qt,t-Gt.now()-Bt)),Ut&&(Ut=clearInterval(Ut))):(Ut||(Wt=Gt.now(),Ut=setInterval(te,1e3)),Tt=1,Yt(Qt)))}function ne(t,e,n){var r=new Zt;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r}Zt.prototype=Kt.prototype={constructor:Zt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Vt():+n)+(null==e?0:+e),this._next||qt===this||(qt?qt._next=this:Jt=this,qt=this),this._call=t,this._time=n,ee()},stop:function(){this._call&&(this._call=null,this._time=1/0,ee())}};var re=Rt("start","end","cancel","interrupt"),ie=[];function oe(t,e,n,r,i,o){var l=t.__transition;if(l){if(n in l)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(s){var u,c,f,h;if(1!==n.state)return a();for(u in i)if((h=i[u]).name===n.name){if(3===h.state)return ne(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[u]):+u<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[u])}if(ne((function(){3===n.state&&(n.state=4,n.timer.restart(l,n.delay,n.time),l(s))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function l(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,l=r.length;++o<l;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Kt((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:re,tween:ie,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function le(t,e){var n=se(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ae(t,e){var n=se(t,e);if(n.state>3)throw new Error("too late; already running");return n}function se(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ue(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ce,fe,he,pe,de=180/Math.PI,ge={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ye(t,e,n,r,i,o){var l,a,s;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,s/=a),t*r<e*n&&(t=-t,e=-e,s=-s,l=-l),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*de,skewX:Math.atan(s)*de,scaleX:l,scaleY:a}}function me(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,l){var a=[],s=[];return o=t(o),l=t(l),function(t,r,i,o,l,a){if(t!==i||r!==o){var s=l.push("translate(",null,e,null,n);a.push({i:s-4,x:ue(t,i)},{i:s-2,x:ue(r,o)})}else(i||o)&&l.push("translate("+i+e+o+n)}(o.translateX,o.translateY,l.translateX,l.translateY,a,s),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:ue(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,l.rotate,a,s),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:ue(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,l.skewX,a,s),function(t,e,n,r,o,l){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");l.push({i:a-4,x:ue(t,n)},{i:a-2,x:ue(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,l.scaleX,l.scaleY,a,s),o=l=null,function(t){for(var e,n=-1,r=s.length;++n<r;)a[(e=s[n]).i]=e.x(t);return a.join("")}}}var ve=me((function(t){return"none"===t?ge:(ce||(ce=document.createElement("DIV"),fe=document.documentElement,he=document.defaultView),ce.style.transform=t,t=he.getComputedStyle(fe.appendChild(ce),null).getPropertyValue("transform"),fe.removeChild(ce),ye(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),xe=me((function(t){return null==t?ge:(pe||(pe=document.createElementNS("http://www.w3.org/2000/svg","g")),pe.setAttribute("transform",t),(t=pe.transform.baseVal.consolidate())?ye((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ge)}),", ",")",")");function we(t,e){var n,r;return function(){var i=ae(this,t),o=i.tween;if(o!==n)for(var l=0,a=(r=n=o).length;l<a;++l)if(r[l].name===e){(r=r.slice()).splice(l,1);break}i.tween=r}}function be(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=ae(this,t),l=o.tween;if(l!==r){i=(r=l).slice();for(var a={name:e,value:n},s=0,u=i.length;s<u;++s)if(i[s].name===e){i[s]=a;break}s===u&&i.push(a)}o.tween=i}}function _e(t,e,n){var r=t._id;return t.each((function(){var t=ae(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return se(t,r).value[e]}}function Me(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ae(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ke(){}var Oe=.7,Ne=1/Oe,Se="\\s*([+-]?\\d+)\\s*",Ie="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",$e="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",De=/^#([0-9a-f]{3,8})$/,Pe=new RegExp("^rgb\\("+[Se,Se,Se]+"\\)$"),Ce=new RegExp("^rgb\\("+[$e,$e,$e]+"\\)$"),Le=new RegExp("^rgba\\("+[Se,Se,Se,Ie]+"\\)$"),ze=new RegExp("^rgba\\("+[$e,$e,$e,Ie]+"\\)$"),Ee=new RegExp("^hsl\\("+[Ie,$e,$e]+"\\)$"),je=new RegExp("^hsla\\("+[Ie,$e,$e,Ie]+"\\)$"),Re={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Je(){return this.rgb().formatHex()}function qe(){return this.rgb().formatRgb()}function Te(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=De.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?He(e):3===n?new Be(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ue(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ue(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Pe.exec(t))?new Be(e[1],e[2],e[3],1):(e=Ce.exec(t))?new Be(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Le.exec(t))?Ue(e[1],e[2],e[3],e[4]):(e=ze.exec(t))?Ue(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ee.exec(t))?Fe(e[1],e[2]/100,e[3]/100,1):(e=je.exec(t))?Fe(e[1],e[2]/100,e[3]/100,e[4]):Re.hasOwnProperty(t)?He(Re[t]):"transparent"===t?new Be(NaN,NaN,NaN,0):null}function He(t){return new Be(t>>16&255,t>>8&255,255&t,1)}function Ue(t,e,n,r){return r<=0&&(t=e=n=NaN),new Be(t,e,n,r)}function We(t){return t instanceof ke||(t=Te(t)),t?new Be((t=t.rgb()).r,t.g,t.b,t.opacity):new Be}function Xe(t,e,n,r){return 1===arguments.length?We(t):new Be(t,e,n,null==r?1:r)}function Be(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ge(){return"#"+Ve(this.r)+Ve(this.g)+Ve(this.b)}function Ye(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ve(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Fe(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ke(t,e,n,r)}function Ze(t){if(t instanceof Ke)return new Ke(t.h,t.s,t.l,t.opacity);if(t instanceof ke||(t=Te(t)),!t)return new Ke;if(t instanceof Ke)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),l=NaN,a=o-i,s=(o+i)/2;return a?(l=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=s<.5?o+i:2-o-i,l*=60):a=s>0&&s<1?0:l,new Ke(l,a,s,t.opacity)}function Ke(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Qe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function tn(t,e,n,r,i){var o=t*t,l=o*t;return((1-3*t+3*o-l)*e+(4-6*o+3*l)*n+(1+3*t+3*o-3*l)*r+l*i)/6}function en(t){return function(){return t}}function nn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):en(isNaN(t)?e:t)}Me(ke,Te,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Je,formatHex:Je,formatHsl:function(){return Ze(this).formatHsl()},formatRgb:qe,toString:qe}),Me(Be,Xe,Ae(ke,{brighter:function(t){return t=null==t?Ne:Math.pow(Ne,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Oe:Math.pow(Oe,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ge,formatHex:Ge,formatRgb:Ye,toString:Ye})),Me(Ke,(function(t,e,n,r){return 1===arguments.length?Ze(t):new Ke(t,e,n,null==r?1:r)}),Ae(ke,{brighter:function(t){return t=null==t?Ne:Math.pow(Ne,t),new Ke(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Oe:Math.pow(Oe,t),new Ke(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Be(Qe(t>=240?t-240:t+120,i,r),Qe(t,i,r),Qe(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const rn=function t(e){var n=function(t){return 1==(t=+t)?nn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):en(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Xe(t)).r,(e=Xe(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),l=nn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=l(e),t+""}}return r.gamma=t,r}(1);function on(t){return function(e){var n,r,i=e.length,o=new Array(i),l=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=Xe(e[n]),o[n]=r.r||0,l[n]=r.g||0,a[n]=r.b||0;return o=t(o),l=t(l),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=l(t),r.b=a(t),r+""}}}on((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],l=r>0?t[r-1]:2*i-o,a=r<e-1?t[r+2]:2*o-i;return tn((n-r/e)*e,l,i,o,a)}})),on((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],l=t[(r+1)%e],a=t[(r+2)%e];return tn((n-r/e)*e,i,o,l,a)}}));var ln=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,an=new RegExp(ln.source,"g");function sn(t,e){var n,r,i,o=ln.lastIndex=an.lastIndex=0,l=-1,a=[],s=[];for(t+="",e+="";(n=ln.exec(t))&&(r=an.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[l]?a[l]+=i:a[++l]=i),(n=n[0])===(r=r[0])?a[l]?a[l]+=r:a[++l]=r:(a[++l]=null,s.push({i:l,x:ue(n,r)})),o=an.lastIndex;return o<e.length&&(i=e.slice(o),a[l]?a[l]+=i:a[++l]=i),a.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)a[(n=s[r]).i]=n.x(t);return a.join("")})}function un(t,e){var n;return("number"==typeof e?ue:e instanceof Te?rn:(n=Te(e))?(e=n,rn):sn)(t,e)}function cn(t){return function(){this.removeAttribute(t)}}function fn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hn(t,e,n){var r,i,o=n+"";return function(){var l=this.getAttribute(t);return l===o?null:l===r?i:i=e(r=l,n)}}function pn(t,e,n){var r,i,o=n+"";return function(){var l=this.getAttributeNS(t.space,t.local);return l===o?null:l===r?i:i=e(r=l,n)}}function dn(t,e,n){var r,i,o;return function(){var l,a,s=n(this);if(null!=s)return(l=this.getAttribute(t))===(a=s+"")?null:l===r&&a===i?o:(i=a,o=e(r=l,s));this.removeAttribute(t)}}function gn(t,e,n){var r,i,o;return function(){var l,a,s=n(this);if(null!=s)return(l=this.getAttributeNS(t.space,t.local))===(a=s+"")?null:l===r&&a===i?o:(i=a,o=e(r=l,s));this.removeAttributeNS(t.space,t.local)}}function yn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function mn(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function vn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&mn(t,i)),n}return i._value=e,i}function xn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&yn(t,i)),n}return i._value=e,i}function wn(t,e){return function(){le(this,t).delay=+e.apply(this,arguments)}}function bn(t,e){return e=+e,function(){le(this,t).delay=e}}function _n(t,e){return function(){ae(this,t).duration=+e.apply(this,arguments)}}function Mn(t,e){return e=+e,function(){ae(this,t).duration=e}}function An(t,e){if("function"!=typeof e)throw new Error;return function(){ae(this,t).ease=e}}function kn(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?le:ae;return function(){var l=o(this,t),a=l.on;a!==r&&(i=(r=a).copy()).on(e,n),l.on=i}}var On=Dt.prototype.constructor;function Nn(t){return function(){this.style.removeProperty(t)}}function Sn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function In(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Sn(t,o,n)),r}return o._value=e,o}function $n(t){return function(e){this.textContent=t.call(this,e)}}function Dn(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&$n(r)),e}return r._value=t,r}var Pn=0;function Cn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ln(){return++Pn}var zn=Dt.prototype;Cn.prototype=function(t){return Dt().transition(t)}.prototype={constructor:Cn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=b(t));for(var r=this._groups,i=r.length,o=new Array(i),l=0;l<i;++l)for(var a,s,u=r[l],c=u.length,f=o[l]=new Array(c),h=0;h<c;++h)(a=u[h])&&(s=t.call(a,a.__data__,h,u))&&("__data__"in a&&(s.__data__=a.__data__),f[h]=s,oe(f[h],e,n,h,f,se(a,n)));return new Cn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=A(t));for(var r=this._groups,i=r.length,o=[],l=[],a=0;a<i;++a)for(var s,u=r[a],c=u.length,f=0;f<c;++f)if(s=u[f]){for(var h,p=t.call(s,s.__data__,f,u),d=se(s,n),g=0,y=p.length;g<y;++g)(h=p[g])&&oe(h,e,n,g,p,d);o.push(p),l.push(s)}return new Cn(o,l,e,n)},filter:function(t){"function"!=typeof t&&(t=k(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,l=e[i],a=l.length,s=r[i]=[],u=0;u<a;++u)(o=l[u])&&t.call(o,o.__data__,u,l)&&s.push(o);return new Cn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),l=new Array(r),a=0;a<o;++a)for(var s,u=e[a],c=n[a],f=u.length,h=l[a]=new Array(f),p=0;p<f;++p)(s=u[p]||c[p])&&(h[p]=s);for(;a<r;++a)l[a]=e[a];return new Cn(l,this._parents,this._name,this._id)},selection:function(){return new On(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ln(),r=this._groups,i=r.length,o=0;o<i;++o)for(var l,a=r[o],s=a.length,u=0;u<s;++u)if(l=a[u]){var c=se(l,e);oe(l,t,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Cn(r,this._parents,t,n)},call:zn.call,nodes:zn.nodes,node:zn.node,size:zn.size,empty:zn.empty,each:zn.each,on:function(t,e){var n=this._id;return arguments.length<2?se(this.node(),n).on.on(t):this.each(kn(n,t,e))},attr:function(t,e){var n=C(t),r="transform"===n?xe:un;return this.attrTween(t,"function"==typeof e?(n.local?gn:dn)(n,r,_e(this,"attr."+t,e)):null==e?(n.local?fn:cn)(n):(n.local?pn:hn)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=C(t);return this.tween(n,(r.local?vn:xn)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?ve:un;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=X(this,t),l=(this.style.removeProperty(t),X(this,t));return o===l?null:o===n&&l===r?i:i=e(n=o,r=l)}}(t,r)).on("end.style."+t,Nn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var l=X(this,t),a=n(this),s=a+"";return null==a&&(this.style.removeProperty(t),s=a=X(this,t)),l===s?null:l===r&&s===i?o:(i=s,o=e(r=l,a))}}(t,r,_e(this,"style."+t,e))).each(function(t,e){var n,r,i,o,l="style."+e,a="end."+l;return function(){var s=ae(this,t),u=s.on,c=null==s.value[l]?o||(o=Nn(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(a,i=c),s.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var l=X(this,t);return l===o?null:l===r?i:i=e(r=l,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,In(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(_e(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Dn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=se(this.node(),n).tween,o=0,l=i.length;o<l;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?we:be)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?wn:bn)(e,t)):se(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?_n:Mn)(e,t)):se(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(An(e,t)):se(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,l){var a={value:l},s={value:function(){0==--i&&o()}};n.each((function(){var n=ae(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(s)),n.on=e}))}))}};var En={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function jn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return En.time=Vt(),En;return n}function Rn(t){return{type:t}}function Jn(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Dt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,l=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):l=!1;l&&delete t.__transition}}(this,t)}))},Dt.prototype.transition=function(t){var e,n;t instanceof Cn?(e=t._id,t=t._name):(e=Ln(),(n=En).time=Vt(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var l,a=r[o],s=a.length,u=0;u<s;++u)(l=a[u])&&oe(l,t,e,u,a,n||jn(l,e));return new Cn(r,this._parents,t,e)},["w","e"].map(Rn),["n","s"].map(Rn),["n","w","e","s","nw","ne","sw","se"].map(Rn);var qn=function(t){return 1===t.length&&(t=function(t){return function(e,n){return Jn(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}(Jn);qn.right,qn.left;var Tn=Array.prototype;Tn.slice,Tn.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2),Math.cos,Math.sin,Math.PI,Math.max,Array.prototype.slice;var Hn="$";function Un(){}function Wn(t,e){var n=new Un;if(t instanceof Un)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var l in t)n.set(l,t[l]);return n}function Xn(){}Un.prototype=Wn.prototype={constructor:Un,has:function(t){return Hn+t in this},get:function(t){return this[Hn+t]},set:function(t,e){return this[Hn+t]=e,this},remove:function(t){var e=Hn+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Hn&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Hn&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Hn&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Hn&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Hn&&++t;return t},empty:function(){for(var t in this)if(t[0]===Hn)return!1;return!0},each:function(t){for(var e in this)e[0]===Hn&&t(this[e],e.slice(1),this)}};var Bn=Wn.prototype;function Gn(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Xn.prototype=function(t,e){var n=new Xn;if(t instanceof Xn)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}.prototype={constructor:Xn,has:Bn.has,add:function(t){return this[Hn+(t+="")]=t,this},remove:Bn.remove,clear:Bn.clear,values:Bn.keys,size:Bn.size,empty:Bn.empty,each:Bn.each};var Yn=function(t){return 1===t.length&&(t=function(t){return function(e,n){return Gn(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}(Gn);Yn.right,Yn.left;var Vn=Array.prototype;function Fn(){return Math.random()}Vn.slice,Vn.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2),Array.prototype.slice,Math.PI,Math.sqrt(5),function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Fn);const Zn=function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(Fn),Kn=(function t(e){function n(){var t=Zn.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Fn),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(Fn));function Qn(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}(function t(e){function n(t){var n=Kn.source(e)(t);return function(){return n()/t}}return n.source=t,n})(Fn),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Fn);var tr=function(t){return 1===t.length&&(t=function(t){return function(e,n){return Qn(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}(Qn);tr.right,tr.left;var er=Array.prototype;er.slice,er.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var nr=Array.prototype;function rr(t){return"string"==typeof t?new It([[document.querySelector(t)]],[document.documentElement]):new It([[t]],St)}function ir(){this._=null}function or(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function lr(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function ar(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function sr(t){for(;t.L;)t=t.L;return t}nr.map,nr.slice,ir.prototype={constructor:ir,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=sr(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(lr(this,n),n=(t=n).U),n.C=!1,r.C=!0,ar(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(ar(this,n),n=(t=n).U),n.C=!1,r.C=!0,lr(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,l=t.R;if(n=o?l?sr(l):o:l,i?i.L===t?i.L=n:i.R=n:this._=n,o&&l?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==l?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=l,l.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,lr(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ar(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,lr(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,ar(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,lr(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,ar(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};const ur=ir;function cr(t,e,n,r){var i=[null,null],o=Lr.push(i)-1;return i.left=t,i.right=e,n&&hr(i,t,e,n),r&&hr(i,e,t,r),Pr[t.index].halfedges.push(o),Pr[e.index].halfedges.push(o),i}function fr(t,e,n){var r=[e,n];return r.left=t,r}function hr(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function pr(t,e,n,r,i){var o,l=t[0],a=t[1],s=l[0],u=l[1],c=0,f=1,h=a[0]-s,p=a[1]-u;if(o=e-s,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>c&&(c=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<f&&(f=o)}if(o=n-u,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<f&&(f=o)}else if(p>0){if(o>f)return;o>c&&(c=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(o>f)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<f&&(f=o)}return!(c>0||f<1)||(c>0&&(t[0]=[s+c*h,u+c*p]),f<1&&(t[1]=[s+f*h,u+f*p]),!0)}}}}}function dr(t,e,n,r,i){var o=t[1];if(o)return!0;var l,a,s=t[0],u=t.left,c=t.right,f=u[0],h=u[1],p=c[0],d=c[1],g=(f+p)/2,y=(h+d)/2;if(d===h){if(g<e||g>=r)return;if(f>p){if(s){if(s[1]>=i)return}else s=[g,n];o=[g,i]}else{if(s){if(s[1]<n)return}else s=[g,i];o=[g,n]}}else if(a=y-(l=(f-p)/(d-h))*g,l<-1||l>1)if(f>p){if(s){if(s[1]>=i)return}else s=[(n-a)/l,n];o=[(i-a)/l,i]}else{if(s){if(s[1]<n)return}else s=[(i-a)/l,i];o=[(n-a)/l,n]}else if(h<d){if(s){if(s[0]>=r)return}else s=[e,l*e+a];o=[r,l*r+a]}else{if(s){if(s[0]<e)return}else s=[r,l*r+a];o=[e,l*e+a]}return t[0]=s,t[1]=o,!0}function gr(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function yr(t,e){return e[+(e.left!==t.site)]}function mr(t,e){return e[+(e.left===t.site)]}var vr,xr=[];function wr(){or(this),this.x=this.y=this.arc=this.site=this.cy=null}function br(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var l=i[0],a=i[1],s=r[0]-l,u=r[1]-a,c=o[0]-l,f=o[1]-a,h=2*(s*f-u*c);if(!(h>=-Er)){var p=s*s+u*u,d=c*c+f*f,g=(f*p-u*d)/h,y=(s*d-c*p)/h,m=xr.pop()||new wr;m.arc=t,m.site=i,m.x=g+l,m.y=(m.cy=y+a)+Math.sqrt(g*g+y*y),t.circle=m;for(var v=null,x=Cr._;x;)if(m.y<x.y||m.y===x.y&&m.x<=x.x){if(!x.L){v=x.P;break}x=x.L}else{if(!x.R){v=x;break}x=x.R}Cr.insert(v,m),v||(vr=m)}}}}function _r(t){var e=t.circle;e&&(e.P||(vr=e.N),Cr.remove(e),xr.push(e),or(e),t.circle=null)}var Mr=[];function Ar(){or(this),this.edge=this.site=this.circle=null}function kr(t){var e=Mr.pop()||new Ar;return e.site=t,e}function Or(t){_r(t),Dr.remove(t),Mr.push(t),or(t)}function Nr(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,l=t.N,a=[t];Or(t);for(var s=o;s.circle&&Math.abs(n-s.circle.x)<zr&&Math.abs(r-s.circle.cy)<zr;)o=s.P,a.unshift(s),Or(s),s=o;a.unshift(s),_r(s);for(var u=l;u.circle&&Math.abs(n-u.circle.x)<zr&&Math.abs(r-u.circle.cy)<zr;)l=u.N,a.push(u),Or(u),u=l;a.push(u),_r(u);var c,f=a.length;for(c=1;c<f;++c)u=a[c],s=a[c-1],hr(u.edge,s.site,u.site,i);s=a[0],(u=a[f-1]).edge=cr(s.site,u.site,null,i),br(s),br(u)}function Sr(t){for(var e,n,r,i,o=t[0],l=t[1],a=Dr._;a;)if((r=Ir(a,l)-o)>zr)a=a.L;else{if(!((i=o-$r(a,l))>zr)){r>-zr?(e=a.P,n=a):i>-zr?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){Pr[t.index]={site:t,halfedges:[]}}(t);var s=kr(t);if(Dr.insert(e,s),e||n){if(e===n)return _r(e),n=kr(e.site),Dr.insert(s,n),s.edge=n.edge=cr(e.site,s.site),br(e),void br(n);if(n){_r(e),_r(n);var u=e.site,c=u[0],f=u[1],h=t[0]-c,p=t[1]-f,d=n.site,g=d[0]-c,y=d[1]-f,m=2*(h*y-p*g),v=h*h+p*p,x=g*g+y*y,w=[(y*v-p*x)/m+c,(h*x-g*v)/m+f];hr(n.edge,u,d,w),s.edge=cr(u,t,null,w),n.edge=cr(t,d,null,w),br(e),br(n)}else s.edge=cr(e.site,s.site)}}function Ir(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var l=t.P;if(!l)return-1/0;var a=(n=l.site)[0],s=n[1],u=s-e;if(!u)return a;var c=a-r,f=1/o-1/u,h=c/u;return f?(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-s+u/2+i-o/2)))/f+r:(r+a)/2}function $r(t,e){var n=t.N;if(n)return Ir(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var Dr,Pr,Cr,Lr,zr=1e-6,Er=1e-12;function jr(t,e){return e[1]-t[1]||e[0]-t[0]}function Rr(t,e){var n,r,i,o=t.sort(jr).pop();for(Lr=[],Pr=new Array(t.length),Dr=new ur,Cr=new ur;;)if(i=vr,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(Sr(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;Nr(i.arc)}if(function(){for(var t,e,n,r,i=0,o=Pr.length;i<o;++i)if((t=Pr[i])&&(r=(e=t.halfedges).length)){var l=new Array(r),a=new Array(r);for(n=0;n<r;++n)l[n]=n,a[n]=gr(t,Lr[e[n]]);for(l.sort((function(t,e){return a[e]-a[t]})),n=0;n<r;++n)a[n]=e[l[n]];for(n=0;n<r;++n)e[n]=a[n]}}(),e){var l=+e[0][0],a=+e[0][1],s=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,o=Lr.length;o--;)dr(i=Lr[o],t,e,n,r)&&pr(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>zr||Math.abs(i[0][1]-i[1][1])>zr)||delete Lr[o]}(l,a,s,u),function(t,e,n,r){var i,o,l,a,s,u,c,f,h,p,d,g,y=Pr.length,m=!0;for(i=0;i<y;++i)if(o=Pr[i]){for(l=o.site,a=(s=o.halfedges).length;a--;)Lr[s[a]]||s.splice(a,1);for(a=0,u=s.length;a<u;)d=(p=mr(o,Lr[s[a]]))[0],g=p[1],f=(c=yr(o,Lr[s[++a%u]]))[0],h=c[1],(Math.abs(d-f)>zr||Math.abs(g-h)>zr)&&(s.splice(a,0,Lr.push(fr(l,p,Math.abs(d-t)<zr&&r-g>zr?[t,Math.abs(f-t)<zr?h:r]:Math.abs(g-r)<zr&&n-d>zr?[Math.abs(h-r)<zr?f:n,r]:Math.abs(d-n)<zr&&g-e>zr?[n,Math.abs(f-n)<zr?h:e]:Math.abs(g-e)<zr&&d-t>zr?[Math.abs(h-e)<zr?f:t,e]:null))-1),++u);u&&(m=!1)}if(m){var v,x,w,b=1/0;for(i=0,m=null;i<y;++i)(o=Pr[i])&&(w=(v=(l=o.site)[0]-t)*v+(x=l[1]-e)*x)<b&&(b=w,m=o);if(m){var _=[t,e],M=[t,r],A=[n,r],k=[n,e];m.halfedges.push(Lr.push(fr(l=m.site,_,M))-1,Lr.push(fr(l,M,A))-1,Lr.push(fr(l,A,k))-1,Lr.push(fr(l,k,_))-1)}}for(i=0;i<y;++i)(o=Pr[i])&&(o.halfedges.length||delete Pr[i])}(l,a,s,u)}this.edges=Lr,this.cells=Pr,Dr=Cr=Lr=Pr=null}function Jr(t,e,n){this.k=t,this.x=e,this.y=n}Rr.prototype={constructor:Rr,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return yr(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,l,a,s,u,c=n.site,f=-1,h=e[i[o-1]],p=h.left===c?h.right:h.left;++f<o;)l=p,p=(h=e[i[f]]).left===c?h.right:h.left,l&&p&&r<l.index&&r<p.index&&(s=l,u=p,((a=c)[0]-u[0])*(s[1]-a[1])-(a[0]-s[0])*(u[1]-a[1])<0)&&t.push([c.data,l.data,p.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,l=o._found||0,a=o.cells.length;!(i=o.cells[l]);)if(++l>=a)return null;var s=t-i.site[0],u=e-i.site[1],c=s*s+u*u;do{i=o.cells[r=l],l=null,i.halfedges.forEach((function(n){var r=o.edges[n],a=r.left;if(a!==i.site&&a||(a=r.right)){var s=t-a[0],u=e-a[1],f=s*s+u*u;f<c&&(c=f,l=a.index)}}))}while(null!==l);return o._found=r,null==n||c<=n*n?i.site:null}},Jr.prototype={constructor:Jr,scale:function(t){return 1===t?this:new Jr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Jr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Jr(1,0,0),Jr.prototype;const qr=Object.assign(Object.assign({},r),i);function Tr(){let t=null,e=JSON.parse(JSON.stringify(qr));const n=Rt("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=function(r){t=r,function(){let n=t.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${e.plotID}`).size()>0||(e.index=r.size(),e.plotID=`bars-${r.size()}`,n.append("g").classed(`${e.plotID}`,!0))}(),function(){let r=e.ys,i=e.xs,o=t.xScale,l=t.yScale,a=t.chartHeight,s=t.svg,u=e.alpha,c=s.select(`.${e.plotID}`).selectAll(".bar").data(i);c.exit().style("opacity",0).remove();let f=c.enter().append("rect").classed("bar",!0);c=c.merge(f),c.attr("x",(t=>o(t))).attr("y",((t,e)=>l(r[e]))).attr("width",o.bandwidth()).attr("height",((t,e)=>a-l(r[e]))).attr("fill",(({value:t})=>"red")).style("opacity",u).on("mouseover",(function(t){rr(this).style("cursor","pointer"),n.call("customMouseOver",this,t)})).on("mousemove",(function(t){rr(this).style("cursor","pointer"),n.call("customMouseMove",this,t)})).on("mouseout",(function(t){n.call("customMouseOut",this,t)})).on("click",(function(t){n.call("customMouseClick",this,t)}))}()};function i(t){return function(n){return arguments.length?(e[t]=n,r):e[t]}}r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e};for(let t in e)!r[t]&&e.hasOwnProperty(t)&&(r[t]=i(t));return r.extent=function(){return{x:v(e.xs,(t=>t)),y:v(e.ys,(t=>t))}},r}const Hr=Object.assign(Object.assign({},r),i);function Ur(){let t=null,e=JSON.parse(JSON.stringify(Hr));const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=function(n){t=n,function(){let n=t.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${e.plotID}`).size()>0||(e.index=r.size(),e.plotID=`bars-${r.size()}`,n.append("g").classed(`${e.plotID}`,!0))}(),function(){let n=e.ys,r=(e.xs,t.xScale),i=t.yScale,o=t.chartHeight,l=t.svg,a=["Nitrogen","normal","stress"],s=l.select(`.${e.plotID}`),u=d3.scaleBand().domain(a).range([0,r.bandwidth()]).padding([.05]),c=d3.scaleOrdinal().domain(a).range(["#e41a1c","#377eb8","#4daf4a"]),f=s.selectAll("g").data(n),h=f.enter().append("g");f.exit().remove(),f=f.merge(h),f.attr("transform",(function(t){return`translate(${r(t.group)},0)`}));let p=f.selectAll("rect").data((function(t){return a.map((function(e){return{key:e,value:t[e]}}))})),d=p.enter().append("rect");p=p.merge(d),p.attr("x",(function(t){return u(t.key)})).attr("y",(function(t){return i(t.value)})).attr("width",u.bandwidth()).attr("height",(function(t){return o-i(t.value)})).attr("fill",(function(t){return c(t.key)}))}()};function i(t){return function(n){return arguments.length?(e[t]=n,r):e[t]}}r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e};for(let t in e)!r[t]&&e.hasOwnProperty(t)&&(r[t]=i(t));return r.extent=function(){return{x:d3.extent(e.xs,(t=>t)),y:d3.extent(e.ys,(t=>t))}},r}const Wr=Object.assign(Object.assign({},r),i);function Xr(){let t=null,e=JSON.parse(JSON.stringify(Wr));const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=function(r){t=r,function(){let n=t.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${e.plotID}`).size()>0||(e.index=r.size(),e.plotID=`bars-${r.size()}`,n.append("g").classed(`${e.plotID}`,!0))}(),function(){let r=e.ys,i=(e.xs,t.xScale),o=t.yScale,l=t.chartHeight,a=(t.chartWidth,t.svg),s=e.bins,u=e.alpha,c=e.density,f=a.select(`.${e.plotID}`),h=function(n,r){e.xs;let i=t.xScale,o=d3.extent(n);return o[1],o[0],d3.bin().domain(i.domain()).thresholds(r)(n)}(r,s),p=d3.reduce(h,((t,e)=>e.length>t?e.length:t),0),d=p;if(c){let t=0;if(h.length>0){let e=h[0];t=e.x1-e.x0}d=p/(r.length*t)}o.domain()[1]<d&&o.domain([0,d]);let g=f.selectAll(".bar").data(h);g.exit().style("opacity",0).remove();let y=g.enter().append("rect").classed("bar",!0);g=g.merge(y),g.attr("x",(t=>i(t.x0))).attr("y",((t,e)=>{let n=t.length;return c&&(n=t.length/(r.length*(t.x1-t.x0))),o(n)})).attr("width",(t=>i(t.x1)-i(t.x0))).attr("height",((t,e)=>{let n=t.length;return c&&(n=t.length/(r.length*(t.x1-t.x0))),n=l-o(n),n})).attr("fill",(({value:t})=>"red")).style("opacity",u).on("mouseover",(function(t){d3.select(this).style("cursor","pointer"),n.call("customMouseOver",this,t)})).on("mousemove",(function(t){d3.select(this).style("cursor","pointer"),n.call("customMouseMove",this,t)})).on("mouseout",(function(t){n.call("customMouseOut",this,t)})).on("click",(function(t){n.call("customMouseClick",this,t)}))}()};function i(t){return function(n){return arguments.length?(e[t]=n,r):e[t]}}r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e};for(let t in e)!r[t]&&e.hasOwnProperty(t)&&(r[t]=i(t));return r.extent=function(){return{x:d3.extent(e.xs,(t=>t)),y:d3.extent(e.ys,(t=>t))}},r}function Br(){let t=JSON.parse(JSON.stringify(l)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=function(n,r){e=n,function(){let n=e.svg.select("g.metadata-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.legendID}`).size())return;t.index=r.size(),t.legendID=`legend-${t.index}`;let i=n.append("g").classed(`${t.legendID}`,!0).append("g").classed("anchorpoint",!0);i.append("rect").classed("background",!0),i.append("g").classed("innermargin",!0)}(),function(e){let n=e.map((t=>{let e=t.labels()?t.labels():["none"],n=t.colours()?t.colours():["white"];return e.map(((t,e)=>({label:t,colour:n[e]})))}));t.legendData=[].concat.apply([],n)}(r),function(){var n;let r=e.svg.select(`.${t.legendID}`).select("g.anchorpoint"),i=r.select("rect.background"),o=r.select("g.innermargin"),l=t.legendData,a=10,s=null!==(n=t.position)&&void 0!==n?n:"topleft",u=e.chartWidth,c=e.chartHeight,[f,h]=function(t,e,n){let r=0,i=0;switch(t){case"topleft":r=0,i=0;break;case"topright":r=.6*e,i=0;break;case"middleleft":r=0,i=.5*n;break;case"middleright":r=.6*e,i=.5*n;break;case"bottomleft":r=0,i=.6*n;break;case"bottomright":r=.6*e,i=.6*n}return[r,i]}(s,u,c);f+=.05*u,h+=.05*c,r.attr("transform",`translate(${f},${h})`),o.attr("transform","translate(5,5)"),i.attr("x",0).attr("y",0).attr("width",100).attr("height",100).style("fill","white").style("stroke","lightgrey").style("opacity",.95);let p=o.selectAll("rect").data(l);p.exit().style("opacity",0).remove();let d=p.enter().append("rect");p=p.merge(d),p.attr("x",0).attr("y",(function(t,e){return 15*e})).attr("width",a).attr("height",a).style("fill",(function(t){return t.colour}));let g=o.selectAll("text").data(l);g.exit().style("opacity",0).remove();let y=g.enter().append("text");g=g.merge(y),g.attr("x",12).attr("y",(function(t,e){return 15*e+5})).style("fill",(function(t){return t.colour})).text((function(t){return t.label})).attr("text-anchor","left").style("alignment-baseline","middle").style("font-size",".8em")}()};function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e},r.attr=function(){return t},r}const Gr=["red","green","blue","grey"];function Yr(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=Gr)}(),function(){let n=t.xs,r=t.ys,i=t.labels,o=(t.index,t.colour,e.xScale),l=e.yScale,a="";t.alpha,t.style;let s=e.svg.select(`.${t.plotID}`),u=d3.scaleOrdinal().domain(i).range(t.colours),c=function(t,e,n){let r=e.length,i=e[0].length,o=[];for(let t=0;t<i;t++){let i={};for(let o=0;o<r;o++){let r=e[o];i[n[o]]=r[t]}o.push(i)}return o}(0,r,i),f=d3.stack().keys(i).order(d3.stackOrderDescending)(c),h=d3.area().x(((t,e)=>o(n[e]))).y0(((t,e)=>l(t[0]))).y1(((t,e)=>l(t[1]))),p=s.selectAll(".layer").data(f);p.exit().remove(),p.enter().append("g").attr("class","layer").append("path").attr("class","area").style("fill",(t=>u(t.key))).attr("d",((t,e)=>h(t,e)))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i}const Vr=["red","green","blue","grey"];function Fr(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(r){e=r,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.plotID}`).size()>0)return;t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0);let i=t.index%Vr.length;t.colour=Vr[i]}(),function(){let r=t.xs,i=t.ys,o=(t.labels,t.index,t.colour,e.xScale),l=e.yScale,a=e.svg.select(`.${t.plotID}`),s=a.selectAll(".bar").data(i);s.exit().style("opacity",0).remove();let u=s.enter().append("rect").classed("bar",!0);s=s.merge(u),s.attr("x",((t,e)=>o(r[e]))).attr("y",(({open:t,close:e})=>l(Math.max(t,e)))).attr("width",10).attr("height",(({open:t,close:e})=>t==e?1:l(Math.min(t,e))-l(Math.max(t,e)))).attr("fill",(({open:t,close:e})=>t===e?"silver":t>e?"red":"green")).on("mouseover",(function(t){d3.select(this).style("cursor","pointer"),n.call("customMouseOver",this,t)})).on("mousemove",(function(t){n.call("customMouseMove",this,t)})).on("mouseout",(function(t){n.call("customMouseOut",this,t)})).on("click",(function(t){n.call("customMouseClick",this,t)}));let c=a.selectAll(".sticks").data(i);c.exit().style("opacity",0).remove();let f=c.enter().append("line").attr("class","sticks");c=c.merge(f),c.attr("x1",(t=>o(t.date)+5)).attr("x2",(t=>o(t.date)+5)).attr("y1",(t=>l(t.high))).attr("y2",(t=>l(t.low))).attr("stroke",(t=>t.open===t.close?"white":t.open>t.close?"red":"green"))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i}function Zr(){let t=1;function e(e,r){let i=r?e.map(r):e,o=(t%2==0?t:t+1)/2,l=(a=o,s=o,u=i,_.chain(u).map(function(t,e){return function(n,r,i){const o=Math.max(0,r-t),l=Math.min(i.length,r+e+1);return _.slice(i,o,l)}}(a,s)).map(n).value());var a,s,u;return l}function n(t){return function(t){return _.reduce(t,((t,e)=>t+e),0)}(t)/(t.length||1)}let r=e;return e.window_size=function(e){return arguments.length?(t=e,r):t},e}const Kr=["red","green","blue","grey"];function Qr(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.plotID}`).size()>0)return;t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0);let i=t.index%Kr.length;t.colour=Kr[i]}(),function(){let n=t.xs,r=t.ys,i=t.where,o=t.labels,l=t.colours,a=e.xScale,s=e.yScale,u=function(t){let e=t.xs,n=t.ys,r=t.where;function i(t,e,n,r,i){return r+(n-t)/(e-t)*(i-r)}return function(){let{startDataIdx:t,startIdx:o,endIdx:l,endDataIdx:a}=function(){let t=0,n=0,i=e.length>0?e.length-1:0,o=i;for(let i=0;i<e.length;i++){if(r(e[i])){n=i;break}t=i}for(let t=n;t<e.length;t++){if(!1===r(e[t])){o=t;break}i=t}return{startDataIdx:t,startIdx:n,endIdx:i,endDataIdx:o}}(),s=e.slice(o,l+1),u=n.slice(o,l+1);if(t<o){let l=e[t],a=e[o],c=function(t,e,n){let r=t,i=e,o=e;for(let t=0;t<4;t++)o=i-.5*(i-r),n(o)?i=o:r=o;return o}(l,a,r);s.unshift(c);let f=i(l,a,c,n[t],n[o]);u.unshift(f)}if(l<a){let t=e[a],o=e[l],c=function(t,e,n){let r=e,i=t,o=e;for(let t=0;t<4;t++)o=i-.5*(i-r),n(o)?r=o:i=o;return o}(t,o,r);s.push(c);let f=n[a],h=i(o,t,c,n[l],f);u.push(h)}return{newXs:s,newYs:u}}}({xs:n,ys:r,where:i}),{newXs:c,newYs:f}=u(),h=t.alpha,p="";t.style;let d=e.svg.select(`.${t.plotID}`),g=d3.scaleOrdinal().domain(o).range(l),y=d3.area().x(((t,e)=>a(c[e]))).y0(((t,e)=>{let n=s.domain()[0];return s(n)})).y1(((t,e)=>s(t))),m=d.selectAll("path").data([f]);m.exit().remove();let v=m.enter().append("path").attr("class","fill_between");m=m.merge(v),m.style("fill",(t=>g(t.key))).style("opacity",h).attr("d",((t,e)=>y(t,e)))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.where=function(e){return arguments.length?(t.where=e,i):t.where},i}const ti=["red","green","blue","grey"];function ei(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=ti)}(),function(){let n=t.xs,r=t.ys,i=t.labels,o=(t.index,t.colour,e.xScale),l=e.yScale,a="";t.alpha,t.style;let s=e.svg.select(`.${t.plotID}`),u=d3.scaleOrdinal().domain(i).range(t.colours),c=function(t,e,n){let r=e.length,i=e[0].length,o=[];for(let t=0;t<i;t++){let i={};for(let o=0;o<r;o++){let r=e[o];i[n[o]]=r[t]}o.push(i)}return o}(0,r,i),f=d3.stack().keys(i).order(d3.stackOrderDescending)(c);var h=s.selectAll(".layer").data(f);h.enter().append("g").attr("class","layer").style("fill",(function(t,e){return u(t.key)})).selectAll("rect").data((function(t){return t})).enter().append("rect").attr("x",(function(t,e){return o(n[e])})).attr("y",(function(t){return l(t[1])})).attr("height",(function(t){return l(t[0])-l(t[1])})).attr("width",o.bandwidth()),h.exit().remove()}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i}const ni=["red","green","blue","grey"];function ri(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=ni)}(),function(){let n=t.ys,r=t.labels,i=e.xScale,o=e.yScale,l=e.svg.select(`.${t.plotID}`),a=function(t){return t.map((t=>{let e=t.sort(d3.ascending),n=d3.quantile(e,.25),r=d3.quantile(e,.5),i=d3.quantile(e,.75),o=i-n;return{q1:n,median:r,q3:i,interQuantileRange:o,min:n-1.5*o,max:i+1.5*o}}))}(n),s=l.selectAll("vertLines").data(a);s.exit().remove();let u=s.enter().filter((t=>!1===Number.isNaN(t.min))).append("line");s=s.merge(u),s.attr("x1",(function(t,e){return i(r[e])})).attr("x2",(function(t,e){return i(r[e])})).attr("y1",(function(t){return o(t.min)})).attr("y2",(function(t){return o(t.max)})).attr("stroke","black").style("width",40);let c=100,f=l.selectAll("boxes").data(a);f.exit().remove();let h=f.enter().filter((t=>!1===Number.isNaN(t.min))).append("rect");f=h.merge(h),f.attr("x",(function(t,e){return i(r[e])-50})).attr("y",(function(t){return o(t.q3)})).attr("height",(function(t){return o(t.q1)-o(t.q3)})).attr("width",c).attr("stroke","black").style("fill","#69b3a2");let p=l.selectAll("medianLines").data(a);p.exit().remove();let d=p.enter().filter((t=>!1===Number.isNaN(t.min))).append("line");p=p.merge(d),p.attr("x1",(function(t,e){return i(r[e])-50})).attr("x2",(function(t,e){return i(r[e])+50})).attr("y1",(function(t){return o(t.median)})).attr("y2",(function(t){return o(t.median)})).attr("stroke","black").style("width",80)}(),function(){let n=t.ys,r=t.labels,i=e.xScale,o=e.yScale,l=e.svg.select(`.${t.plotID}`),a=l.selectAll("indPoints").data(n);a.exit().remove();let s=a.enter().filter((t=>!1===Number.isNaN(t.min))).append("g");a=a.merge(s),a.attr("transform",((t,e)=>`translate(${i(r[e])},0)`));let u=a.selectAll("circle").data((t=>t));u.exit().remove();let c=u.enter().append("circle");u=u.merge(c),u.attr("cx",(function(t,e){return 50*Math.random()-25})).attr("cy",(function(t){return o(t)})).attr("opacity",.2).attr("r",4).style("fill","white").attr("stroke","black")}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},i}const ii=["red","green","blue","grey"];function oi(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=ii)}(),function(){let n=t.ys,r=t.labels,i=e.xScale,o=e.yScale,l=e.svg.select(`.${t.plotID}`),a=function(n){var r;let i=e.yScale,o=null!==(r=t.bins)&&void 0!==r?r:100,l=d3.bin().domain(i.domain()).thresholds(o);return n.map((t=>l(t)))}(n),s=0,u=0;var c=0;for(let t in a)s=a[t].map((function(t){return t.length})),u=d3.max(s),u>c&&(c=u);let f=i.bandwidth(),h=d3.scaleLinear().range([0,f]).domain([-u,u]),p=l.selectAll("myViolin").data(a);p.exit().remove();let d=p.enter().append("g"),g=d.append("path");p=p.merge(d),p.attr("transform",((t,e)=>`translate(${i(r[e])},0)`));let y=p.selectAll("path").datum((t=>t));y=y.merge(g),y.attr("d",(t=>d3.area().x0((t=>h(-t.length))).x1((t=>h(t.length))).y((t=>o(t.x0))).curve(d3.curveCatmullRom)(t))).style("stroke","none").style("fill","#69b3a2")}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},i}const li=["red","green","blue","grey"];function ai(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=li)}(),function(){let n=t.ys,r=t.labels,i=e.chartWidth,o=e.chartHeight,l=e.svg.select(`.${t.plotID}`),a=Math.min(i,o)/2-0,s=l.attr("transform",`translate(${i/2}, ${o/2})`),u=d3.scaleOrdinal().domain(r).range(d3.schemeDark2),c=function(t){return d3.pie()(t)}(n),f=d3.arc().innerRadius(.5*a).outerRadius(.8*a),h=d3.arc().innerRadius(.9*a).outerRadius(.9*a),p=s.selectAll("allSlices").data(c);p.exit().remove();let d=p.enter().append("path");p=p.merge(d),p.attr("d",f).attr("fill",(function(t,e){return u(r[e])})).attr("stroke","white").style("stroke-width","2px").style("opacity",.7);let g=s.selectAll("allPolylines").data(c);g.exit().remove();let y=g.enter().append("polyline");g=g.merge(y),g.attr("stroke","black").style("fill","none").attr("stroke-width",1).attr("points",(function(t){let e=f.centroid(t),n=h.centroid(t),r=h.centroid(t),i=t.startAngle+(t.endAngle-t.startAngle)/2;return r[0]=.95*a*(i<Math.PI?1:-1),[e,n,r]}));let m=s.selectAll("allLabels").data(c);m.exit().remove();let v=m.enter().append("text");m=m.merge(v),m.text((function(t,e){return r[e]})).attr("transform",(function(t){var e=h.centroid(t),n=t.startAngle+(t.endAngle-t.startAngle)/2;return e[0]=.99*a*(n<Math.PI?1:-1),`translate(${e})`})).style("text-anchor",(function(t){return t.startAngle+(t.endAngle-t.startAngle)/2<Math.PI?"start":"end"}))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},i}const si=["red","green","blue","grey"];function ui(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=si)}(),function(){var n,r;let i=t.ys,o=t.xs,l=(t.index,t.colours,e.xScale),a=e.yScale,s=null!==(n=t.colours)&&void 0!==n?n:["red","green","blue","gray","black"],u=(t.alpha,t.styles,null!==(r=t.curve)&&void 0!==r||d3.curveLinear,e.svg.select(`.${t.plotID}`).selectAll("g").data(i)),c=u.enter().append("g");u.exit().remove(),u=u.merge(c);let f=u.selectAll("circle").data(((t,e)=>t.map((t=>({elem:t,i:e}))))),h=f.enter().append("circle").filter((t=>!1===Number.isNaN(t.elem)));f.exit().remove(),f=f.merge(h),f.attr("cx",(function(t,e){return l(o[e])})).attr("cy",(function(t){return a(t.elem)})).attr("r",1.5).style("fill",(t=>s[t.i]))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},i}const ci=["red","green","blue","grey"];function fi(){let t=JSON.parse(JSON.stringify(r)),e=null;const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let i=function(n){e=n,function(){let n=e.svg.select("g.chart-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`plot-${t.index}`,n.append("g").classed(`${t.plotID}`,!0),t.index,t.colours=ci)}(),function(){var n;let r=t.ys,i=(t.xs,t.index,t.colours,e.xScale),o=e.yScale,l=(t.alpha,t.styles,null!==(n=t.curve)&&void 0!==n||d3.curveLinear,d3.scaleThreshold().domain([.85,1]).range(["#2980B9","#E67E22","#27AE60","#27AE60"])),a=e.svg.select(`.${t.plotID}`).selectAll("g").data(r),s=a.enter().append("g").append("rect");a.exit().remove(),a=a.merge(s),a.attr("class","cell").attr("width",i.bandwidth()).attr("height",o.bandwidth()).attr("y",(function(t){return o(t.country)})).attr("x",(function(t){return i(t.product)})).attr("fill",(function(t){return l(t.value)}))}()};function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return i.on=function(t){let e=n.on.apply(n,arguments);return e===n?i:e},i.attr=function(){return t},i.extent=function(){return{x:d3.extent(t.xs,(t=>t)),y:d3.extent(t.ys,(t=>t))}},i}const hi={map:null,div:null,svg:null,width:500,height:400,margin:{bottom:50,left:40,right:60,top:20},mapWidth:0,mapHeight:0,showMargins:!1,projector:null,zoomer:null,legend:null,position:null,zoom:10,accessToken:null,viewType:null},pi={tag:null,geojson:[],data:[],labels:[],plotID:null,index:null,alpha:[],styles:[],colours:[],curve:null},di=Object.assign(Object.assign({},hi),pi);function gi(){let t=JSON.parse(JSON.stringify(di)),e=[];const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");function r(n){t.showMargins&&t.svg.style("background-color","rgba(255, 0, 0, .2)"),t.chartWidth=t.width-t.margin.left-t.margin.right,t.chartHeight=t.height-t.margin.top-t.margin.bottom,function(e){t.viewType;let n=e,r=(t.accessToken,t.zoom),i=t.position;t.map||(t.map=L.map(n.node()).setView(i,r),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',maxZoom:18,tileSize:512,zoomOffset:-1}).addTo(t.map),L.svg().addTo(t.map))}(n),function(e){let n=null,r=t.map;if(!t.svg){n=e.append("div").classed("custom-map-element",!0).style("height",t.height).style("width",t.width);const i=d3.select(r.getPanes().overlayPane);t.svg=i.select("svg"),t.svg.append("g").classed("map-group",!0)}}(n),t.map.on("zoomend",(()=>{e.forEach((e=>{e(t)}))})),e.forEach((e=>{e(t)}))}let i=r;function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e},r.attr=function(){return t},r.plot=function(t){if(Number.isInteger(t)&&e.length>0)return e[t];if("string"==typeof t){let n=e.filter((e=>e.tag()===t));return n.length>0?n[0]:null}return e.push(t),r},r}const yi=Object.assign({},pi);function mi(){let t=JSON.parse(JSON.stringify(yi)),e=null;function n(n){e=n,function(){let n=e.svg.select("g.map-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`markers-${r.size()}`,n.append("g").classed(`${t.plotID}`,!0))}(),function(){let n=e.map,r=e.svg,i=(function(t){const e=d3.geoTransform({point:function(e,n){const r=t.latLngToLayerPoint(new L.LatLng(n,e));this.stream.point(r.x,r.y)}});d3.geoPath().projection(e)}(n),t.data);let o=r.select(`.${t.plotID}`).selectAll(".boundary").data(i);o.exit().style("opacity",0).remove();let l=o.enter().append("path").classed("boundary",!0);o=o.merge(l),o.attr("d",((t,e,n)=>d3.symbol().type(d3.symbolSquare).size(45)())).attr("transform",(function(t,e,r){let i=t.latlong,o=n.latLngToLayerPoint(new L.LatLng(i[0],i[1]));return`translate(${o.x},${o.y})`})).styles({stroke:"Orange","stroke-width":"1px",fill:"blue"})}()}d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=n;function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return n.attr=function(){return t},n}const vi=Object.assign({},pi);function xi(){let t=JSON.parse(JSON.stringify(vi)),e=null;function n(n){e=n,function(){let n=e.svg.select("g.map-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`layer-${r.size()}`,n.append("g").classed(`${t.plotID}`,!0))}(),function(){let n=e.map,r=e.svg,i=function(t){const e=d3.geoTransform({point:function(e,n){const r=t.latLngToLayerPoint(new L.LatLng(n,e));this.stream.point(r.x,r.y)}});return d3.geoPath().projection(e)}(n),o=t.geojson,l=n.getZoom();const a={stroke:"Orange","stroke-width":"1px","fill-opacity":".3",fill:"green"};let s=r.select(`.${t.plotID}`).selectAll(".boundary").data(o.features);s.exit().style("opacity",0).remove();let u=s.enter().append("path").classed("boundary",!0);s=s.merge(u),s.attr("d",(t=>i(t))).styles((e=>t.onStyle?t.onStyle({elem:e,zoomLevel:l}):a))}()}d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=n;function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return n.attr=function(){return t},n.onStyle=function(e){return arguments.length?(t.onStyle=e,n):t.onStyle},n}const wi=Object.assign(Object.assign({},hi),pi);function bi(){let t=JSON.parse(JSON.stringify(wi)),e=[];const n=d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");function r(n){var r;t.mapWidth=t.width-t.margin.left-t.margin.right,t.mapHeight=t.height-t.margin.top-t.margin.bottom,r=n.node(),t.svg||(t.svg=d3.select(r).append("svg").classed("devgenmap-container",!0),function(e){let n=t.margin.left,r=t.margin.top,i=e.append("g").classed("container-group",!0).attr("transform",`translate(${n},${r})`);i.append("g").classed("map-group",!0),i.append("g").classed("metadata-group",!0)}(t.svg)),t.svg.attr("width",t.width).attr("height",t.height),function(){let n=null==t.projector?null:t.projector;n&&n(t,e)}(),e.forEach((e=>{e(t)})),t.showMargins&&t.svg.style("background-color","rgba(255, 0, 0, .2)"),function(){let n=null==t.zoomer?null:t.zoomer;n&&n(t,e)}()}let i=r;function o(e){return function(n){return arguments.length?(t[e]=n,i):t[e]}}for(let e in t)!i[e]&&t.hasOwnProperty(e)&&(i[e]=o(e));return r.on=function(t){let e=n.on.apply(n,arguments);return e===n?r:e},r.attr=function(){return t},r.plot=function(t){if(Number.isInteger(t)&&e.length>0)return e[t];if("string"==typeof t){let n=e.filter((e=>e.tag()===t));return n.length>0?n[0]:null}return e.push(t),r},r}function _i(){let t={},e=function(e,n){let r=[],i=e.mapWidth,o=e.mapHeight;n.forEach((t=>{let e=t.geojson();"object"!=typeof e||Array.isArray(e)||null===e||(r=e)})),console.log("geojson list: ",r);let l=function(e,n,r){const i=t.projection,o=d3.geoPath().projection(i);i.scale(1).translate([0,0]);var l=o.bounds(e);const a=l[0],s=a[0],u=a[1],c=l[1],f=c[0],h=c[1],p=Math.abs(f-s)/n,d=Math.abs(h-u)/r,g=1/Math.max(p,d);let y=g*(f+s);y=(n-y)/2;let m=g*(h+u);m=(r-m)/2;const v=[y,m];return i.scale(g).translate(v),o}(r,i,o);e.projector=l};function n(n){return function(r){return arguments.length?(t[n]=r,e):t[n]}}for(let r in t)!e[r]&&t.hasOwnProperty(r)&&(e[r]=n(r));return e.attr=function(){return t},e.projection=function(n){return arguments.length?(t.projection=n,e):e.projection},e}const Mi=Object.assign({},pi);function Ai(){let t=JSON.parse(JSON.stringify(Mi)),e=null;function n(n){e=n,function(){let n=e.svg.select("g.map-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`layer-${r.size()}`,n.append("g").classed(`${t.plotID}`,!0))}(),function(){let n=e.svg,r=t.geojson,i=e.projector;const o={stroke:"Brown","stroke-opacity":".2","stroke-width":"1px","fill-opacity":".1",fill:"green"};let l=n.select(`.${t.plotID}`).selectAll(".boundary").data(r.features);l.exit().style("opacity",0).remove();let a=l.enter().append("path").classed("boundary",!0);l=l.merge(a),l.attr("d",(t=>i(t))).styles((e=>t.onStyle?t.onStyle({elem:e}):o))}()}d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=n;function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return n.attr=function(){return t},n.onStyle=function(e){return arguments.length?(t.onStyle=e,n):t.onStyle},n.feature=function(e){return arguments.length?(t.feature=e,n):t.feature},n}const ki=Object.assign({},pi);function Oi(){let t=JSON.parse(JSON.stringify(ki)),e=null;function n(n){e=n,function(){let n=e.svg.select("g.map-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`markers-${r.size()}`,n.append("g").classed(`${t.plotID}`,!0))}(),function(){let n=e.svg,r=t.data,i=e.projector;let o=n.select(`.${t.plotID}`).selectAll(".boundary").data(r);o.exit().style("opacity",0).remove();let l=o.enter().append("path").classed("boundary",!0);o=o.merge(l),o.attr("d",((t,e,n)=>d3.symbol().type(d3.symbolSquare).size(45)())).attr("transform",(function(t,e,n){let r=[+t.long,+t.lat],o=i.projection()(r);return`translate(${o[0]}, ${o[1]})`})).styles({stroke:"brown","stroke-width":"1px",fill:"red"})}()}d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=n;function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return n.attr=function(){return t},n}const Ni=Object.assign({},pi);function Si(){let t=JSON.parse(JSON.stringify(Ni)),e=null;function n(n){e=n,function(){let n=e.svg.select("g.map-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`layer-${r.size()}`,n.append("g").classed(`${t.plotID}`,!0))}(),function(){let n=e.svg,r=t.geojson,i=t.datapoints,o=e.projector.projection(),l=n.select(`.${t.plotID}`),a=r.features[0].geometry.coordinates[0][0].map((t=>o(t))),s=function(t){const n=e.mapWidth,r=e.mapHeight;console.log("map height / width: ",e);const i=n/t,o=Math.floor(r/i);return d3.range(o*t).map(((e,n)=>({x:Math.floor(n%t*i),y:Math.floor(n/t)*i,datapoint:0})))}(160).filter((t=>d3.polygonContains(a,[t.x,t.y]))),u=function(t,e){return t.map((t=>{let n=e([+t.lng,+t.lat]);return{x:n[0],y:n[1],datapoint:1,name:t.MarketName,state:t.State,city:t.city,url:t.Website}}))}(i,o),c=s.concat(u),f=d3.hexbin().radius(4).x((t=>t.x)).y((t=>t.y)),h=f(c),{rolledUpData:p,maxLength:d}=function(t){let e=0,n=[];return t.forEach((t=>{let r=[];t.forEach((t=>{1===t.datapoint&&r.push(t)}));let i={x:t.x,y:t.y,data:r};n.push(i),e=r.length>e?r.length:e})),{rolledUpData:n,maxLength:e}}(h),g=d3.scaleSequential((t=>{let e=Math.pow(t,10);return d3.interpolateViridis(e)})).domain([d,1]),y=(d3.scaleSqrt().domain([0,d]).range([3.5,15]),l.selectAll(".hexes").data(p));y.exit().style("opacity",0).remove();let m=y.enter().append("path").classed("hexes",!0);y=m.merge(y),y.attr("transform",(t=>`translate(${t.x}, ${t.y})`)).attr("d",(t=>f.hexagon())).style("fill",(t=>g(t.data.length))).style("opacity","0.8")}()}d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=n;function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return n.attr=function(){return t},n.onStyle=function(e){return arguments.length?(t.onStyle=e,n):t.onStyle},n.datapoints=function(e){return arguments.length?(t.datapoints=e,n):t.datapoints},n}function Ii(){let t,e={},n=null,r=function(e,r){let i=e.mapWidth,o=e.mapHeight,l=e.svg.select("g.map-group"),a=e.svg.select("g.metadata-group");if(null===n){function s(e,n,r){let i=d3.event.transform;t||(t=!0,setTimeout((()=>{l.attr("transform",i),t=!1}),10))}let u=d3.zoom().on("zoom",s).scaleExtent([1,5]).translateExtent([[0,0],[i,o]]);console.log("what is map group here: ",l),l.call(u),console.log("zoom params: ",e,r,l),a.append("g").classed("zoom-details",!0),n={}}};function i(t){return function(n){return arguments.length?(e[t]=n,r):e[t]}}for(let t in e)!r[t]&&e.hasOwnProperty(t)&&(r[t]=i(t));return r.attr=function(){return e},r}const $i=Object.assign({},pi);function Di(){let t=JSON.parse(JSON.stringify($i)),e=null;function n(n){e=n,function(){let n=e.svg.select("g.map-group"),r=n.selectAll((function(){return this.childNodes}));r.filter(`g.${t.plotID}`).size()>0||(t.index=r.size(),t.plotID=`labels-${r.size()}`,n.append("g").classed(`${t.plotID}`,!0))}(),function(){let n=e.svg,r=t.data,i=e.projector,o=[],l=n.select(`.${t.plotID}`).selectAll(".label").data(r);l.exit().style("opacity",0).remove();let a=l.enter().append("g").classed("label",!0);l=l.merge(a);let s=l.attr("transform",(function(t,e,n){let r=[+t.long,+t.lat],o=i.projection()(r);return`translate(${o[0]}, ${o[1]})`}));s.append("text").attr("x",8).attr("dy","0em").text((t=>t.name)).style("font-size",12).each(((t,e,n)=>{let r=n[e].getComputedTextLength();o.push(r)})),s.append("rect").lower().attr("x",6).attr("y","-1.1em").attr("width",((t,e)=>o[e]+8)).attr("height",20).attr("stroke","gray").attr("stroke-opacity",.2).attr("fill","#fff").style("opacity",.8)}()}d3.dispatch("customMouseOver","customMouseMove","customMouseOut","customMouseClick");let r=n;function i(e){return function(n){return arguments.length?(t[e]=n,r):t[e]}}for(let e in t)!r[e]&&t.hasOwnProperty(e)&&(r[e]=i(e));return n.attr=function(){return t},n}function Pi(){let t=JSON.parse(JSON.stringify(r)),e=null,n=function(n){e=n,function(){let n=e.svg.select("g.metadata-group"),r=n.selectAll((function(){return this.childNodes}));if(r.filter(`g.${t.legendID}`).size())return;t.index=r.size(),t.legendID=`brush-${t.index}`;let i=n.append("g").classed(`${t.legendID}`,!0).append("g").classed("anchorpoint",!0);i.append("rect").classed("background",!0),i.append("g").classed("innermargin",!0)}(),function(){let n=e.svg.select(`.${t.legendID}`).select("g.anchorpoint"),r=n.select("rect.background"),i=n.select("g.innermargin"),o=e.chartHeight,l=e.xScale,a=t.onChange,s=!1,u=!1,c=0;i.attr("transform","translate(0,0)"),r.attr("x",0).attr("y",0).attr("width",100).attr("height",o).style("fill","white").style("stroke","blue").style("opacity",.45).on("mousemove",(function(t,e,n){let r=d3.select(n[e]);if(r.style("cursor","grab"),u&&s){const t=d3.mouse(n[e]),i=l.invert(t[0]),o=(l.invert(r.attr("x")),+r.attr("x")),s=+r.attr("width");let u=l(i)-c,f=l.domain()[0],h=l.domain()[1],p=u<l(f),d=+(u+s)>l(h);if(u=p?o:u,u=d?o:u,r.attr("x",u),!p&&!d){let t=l.invert(u),e=+r.attr("width"),n=[t,l.invert(u+e)],i=l.copy();i.domain(n),a(i)}}})).on("mouseenter",(function(t,e,n){s=!0})).on("mouseleave",(function(t,e,n){s=!1,u=!1})).on("mousedown",(function(t,e,n){u=!0;let r=d3.select(n[e]).attr("x"),i=d3.mouse(n[e]),o=l.invert(i[0]);c=Math.abs(r-l(o))})).on("mouseup",(function(t,e,n){u=!1}));let f=l.invert(0),h=+r.attr("width"),p=[f,l.invert(0+h)],d=l.copy();d.domain(p),a(d)}()};function i(e){return function(r){return arguments.length?(t[e]=r,n):t[e]}}for(let e in t)!n[e]&&t.hasOwnProperty(e)&&(n[e]=i(e));return n.attr=function(){return t},n.onChange=function(e){return arguments.length?(t.onChange=e,n):t.onChange},n}return e})()));